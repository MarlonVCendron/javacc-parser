options {
  //DEBUG_PARSER = true;
  //DEBUG_TOKEN_MANAGER = true;
  UNICODE_INPUT=true;
  JAVA_UNICODE_ESCAPE = true;
  static = false;
}

PARSER_BEGIN(Lang)

import java.io.FileInputStream;
import java.io.File;
import java.io.IOException;

public class Lang {
  public static void main(String args[]) throws ParseException{
    try{
      System.out.println("Lendo arquivo fonte");
      FileInputStream fis = new FileInputStream(new File("fonte.txt"));
      Lang parser = new Lang(fis);
      parser.Start();
      System.out.println("üéâüéâüéâ‚≠êÔ∏è‚≠êÔ∏è‚ú®‚ú®Arquivo fonte processado com sucesso");
    } catch (IOException e) {
      System.out.println("Erro");
      System.exit(0);
    }
  }
}

PARSER_END(Lang)

<*> SKIP: {
  <SKIP_CHAR: " " | "\t" | "\r" | "\n" | "\r\n"> |
  <SL_COMMENT: "//" (~["\n","\r"])* ("\n"|"\r"|"\r\n")> |
  <ML_COMMENT: "/*" (~["*"])* "*" (~["*","/"] (~["*"])* "*" | "*")* "/">
}

TOKEN : {
  <WS : " " | "\t"> |
  <EOL : ";"> |
  <SBOOLEAN_OP : "<" | ">" | "==" | "<=" | ">=" | "!="> |
  <MBOOLEAN_OP : "&&" | "||"> |
  <ARITH_OP : "+" | "-" | "*" | "/" | "%" | "^" | "%">
}

TOKEN : {
  <IF : "if"> |
  <ELSE : "else"> |
  <ELSEIF : "elseif"> |
  <FOR : "for"> |
  <WHILE : "while"> |
  <BREAK : "break"> |
  <CONTINUE: "continue"> |
  <SCAN : "scan"> |
  <PRINT : "print"> |
  <RETURN : "return"> |
  <FUNC : "func">
}

TOKEN : {
  <TYPE : (<INT> | <FLOAT> | <DOUBLE> | <STRING> | <BOOL>)> |
  <#INT : "int"> |
  <#FLOAT : "float"> |
  <#DOUBLE : "double"> |
  <#STRING : "string"> |
  <#BOOL : "bool">
}

TOKEN : {
  <#DIGIT : ["0"-"9"]> |
  <#INTEGER : (<DIGIT>)+> |
  <#BOOLEAN : ("true" | "false")> |
  <#START_CHAR:     ~["\u0000"-"\u001F", "\"", "\\", "(", ")", "{", "}", "+", "-", "*", "/", "^", "%", ",", " ", "=", ";", "0"-"9"]> |
  <#CONTINUE_CHAR : ~["\u0000"-"\u001F", "\"", "\\", "(", ")", "{", "}", "+", "-", "*", "/", "^", "%", ",", " ", "=", ";"]> |
  <#UCHAR : ~["\u0000"-"\u001F", "\"", "\\"]>
}

void IDR() : {} {
  <LITERAL>(LOOKAHEAD(2) ","<LITERAL>)*
} 

void IDIR() : {} {
  (LOOKAHEAD(2) Expression() | <LITERAL>)(LOOKAHEAD(4) ","<LITERAL>"="(LOOKAHEAD(2) Expression() | <LITERAL>))*
} 

void ID() : {} {
  <TYPE> <LITERAL> (","IDR() | "="IDIR())*
} 

TOKEN : {
  <VALUE : 
    <BOOLEAN> |
    <NUMBER> |
    "null" |
    "\""(<UCHAR>)*"\""
  > |
  <#NUMBER : <INTEGER>("."<INTEGER>)?>
}

TOKEN : {
  <LITERAL : <START_CHAR>(<CONTINUE_CHAR>)*>
}

void Expression(): {} {
  LOOKAHEAD(2) BooleanExpression() | ArithExpression()
} 
void BooleanExpression(): {} {
  (<LITERAL> | <VALUE>) <SBOOLEAN_OP> (<LITERAL> | <VALUE>)
} 

void ArithExpression (): {} {
  (<LITERAL> | <VALUE>) (<ARITH_OP> (<LITERAL> | <VALUE>))*
} 

void Assignment(): {} {
  <LITERAL>"="Expression()
} 

void For() : {} {
  <FOR>"(" (ID())? <EOL> (BooleanExpression())? <EOL> (Assignment())? ")" "{"
    (Statement())*
  "}"
}

void While() : {} {
  <WHILE>"("(BooleanExpression())?")" "{"
    (Statement())*
  "}"
}

void ParametersDefinition() : {} {
  <TYPE> <LITERAL> ("," <TYPE> <LITERAL> ("=" Expression())?)*
}

void FunctionDefinition() : {} {
  <FUNC> <LITERAL> "(" (ParametersDefinition())? ")" "{"
    (Statement())*
  "}"
}

void Parameters() : {} {
  (LOOKAHEAD(2) <LITERAL>"=")? Expression() ("," Parameters())?
}

void FunctionName() : {} {
  <LITERAL> | <SCAN> | <PRINT>
}

void Function() : {} {
  FunctionName() "(" (Parameters())? ")"
}

void Return() : {} {
  <RETURN> (Expression())? <EOL>
}

void IfElse() : {} {
  <IF> "(" BooleanExpression() ")" "{"
    (Statement())*
  "}"
  (
    <ELSEIF> "(" BooleanExpression() ")" "{"
      (Statement())*
    "}"
  )*
  (
    <ELSE> "{"
      (Statement())*
    "}"
  )?
}

void Statement() : {} {
  LOOKAHEAD(2)
  Assignment()<EOL> |
  Function() <EOL> |
  ID()<EOL> |
  For() |
  IfElse() |
  While() |
  FunctionDefinition() |
  Return() |
  <BREAK><EOL> |
  <CONTINUE><EOL>
}

void Start() : {} {
  (Statement())*
  <EOF>
} 




